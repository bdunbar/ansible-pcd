---
##
# pcd-services/php prepare
#

- { include: prepare-debian.yml, when: "ansible_os_family == 'Debian'" }
- { include: prepare-redhat.yml, when: "ansible_os_family == 'RedHat'" }


# @todo ensure nginx user can write to php log as well...   
- name: ensure logging directory exists, is writable by webserver
  file: 
    path="{{ os_php_error_log | dirname }}" 
    state=directory
    owner="{{ os_apache_user }}"
    group="{{ os_apache_group }}"
  

- name: enable error logging to file
  lineinfile:
    state=present
    regexp="^error_log \="
    line="error_log = {{ os_php_error_log }}"
    dest="{{ os_php_ini }}"
  notify: 
    - apache reload
    

