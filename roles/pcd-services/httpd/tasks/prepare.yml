---
##
# pcd-services/httpd prepare
#

- name: add {{ httpd_user_group }} group
  group: name={{ httpd_user_group }} system=yes
  

- { include: "{{ pcd_task_add_user }}", task: {
      name: "{{ httpd_user }}",
      group: "{{ httpd_user_group }}", 
      home: "{{ httpd_user_home }}",
      system: yes,
      github: yes,
      key: "{{ httpd_user_key }}"
    }
  }
  
- name: ensure log directory
  file: 
    path={{ HTTPD_LOG_DIR }}
    state=directory
    owner={{ httpd_user }}
    mode=0777
    
- name: ensure default organization directory
  file: 
    path={{ PCD_SITES_DIR }}/{{ httpd_site_org }}
    state=directory
    owner={{ httpd_user }}
    group={{ httpd_user_group }}
    mode=0775
  
- name: ensure ssl certificate directory
  file: 
    path={{ httpd_ssl_dir }}
    state=directory
    owner={{ httpd_user }}
    group={{ httpd_user_group }}
    mode=0775
    