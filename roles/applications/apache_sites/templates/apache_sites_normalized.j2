# Apache Site Definitions
# 
#   name: site name, typically www.domain.com
#
#   org: site organization, defaults to {{ apache_sites_default_org }}
#
#   repo: git repository containing site files
#
#   branches: branches to checkout, defaults to ["master"]. checked out to;
#     {{ apache_sites_user_home }}/<org>/<name>/<branch> }}  e.g.
#     /sites/iceburg/www.iceburg.net/master
#   
#   template: jinja template of apache config file (virtualhost definition),
#      defaults to apache_config.j2, can be full path.
#
#   docroot: document root (path to public web files) within repository,
#      defaults to "www", can be empty. "www" represents;
#      {{ apache_sites_user_home }}/<org>/<name>/<branch>/www  e.g.
#      DocumentRoot /sites/iceburg/www.iceburg.net/master/www
#  
##################### 

apache_sites_list:
{% for item in apache_sites_enabled_list %}
  - { name: "{{ item.name }}",
      repo: "{{ item.repo }}",
      branches: {{ item.branches | default("['master']") }},
      dir: "{{ apache_sites_user_home }}/{{ item.org | default(apache_sites_default_org) }}/{{ item.name }}",
      docroot: "{{ item.docroot | default(apache_sites_default_docroot) }}",
      template: "{{ item.template | default(apache_sites_default_template) }}",
      {% if apache_sites_mysql_list[item.name] is defined %}
        mysql: True,
        mysql_dbs: {{ apache_sites_mysql_list[item.name] }}
      {% else %}
        mysql: False
      {% endif %}
    }
{% endfor %}