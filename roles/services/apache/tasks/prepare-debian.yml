---
##
# [DEBIAN] apache preparation tasks 
#

- name: ensure apache packages 
  apt: pkg={{ item }} state=present
  with_items: os_apache_packages

- name: enable modules
  command: a2enmod {{ item }} creates=/etc/apache2/mods-enabled/{{ item }}.load
  with_items:
    - ssl
    - proxy
    - proxy_http
    - rewrite
  notify:
    - apache restart

- name: disable default sites
  command: a2dissite {{ item }} removes=/etc/apache2/sites-enabled/{{ item }}
  with_items:
    - default
    - default-ssl
  notify:
    - apache restart
